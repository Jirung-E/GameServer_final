# Game Server Termproject
MMORPG 서버 제작

주어진 `game_header.h`를 기반으로 MMORPG 서버를 제작한다.

- 2000x2000의 월드에 20만 마리의 몬스터와 5000명의 플레이어가 존재
- 몬스터는 근처에 플레이어가 있으면 쫓아가서 공격한다. 
- 몬스터는 고정위치로부터 일정 거리 이상 멀어지지 않는다.
- 사용자는 아이디를 이용해 로그인한다. 
- 사용자의 캐릭터는 몬스터를 사냥해서 경험치를 얻고 레벨업한다. 레벨에 따른 요구 경험치는 배로 증가한다.
- 사용자 캐릭터의 체력이 100%가 아니라면 5초마다 10%의 체력을 회복한다. 레벨업시에는 체력이 100%로 회복된다.
- 체력이 0이 되면 경험치가 감소하고(레벨이 감소할수도 있다) 가장 가까운 스폰위치에서 부활한다.
- 채팅이 가능하다.

> 추가할만한 기능  
> - 마을에는 몬스터가 출입할 수 없으며, 플레이어의 체력이 닳지 않도록 한다.
> - 보스몬스터
> - 아이템 획득 및 사용


## 주요기능
- 지형
- 몬스터 AI
- 전투
- 로그인
- 채팅


## 요구사항
- [Use Case Diagram](docs/usecase.drawio)
- [요구사항추적표](docs/요구사항추적표.xlsx)


## 요구사항분석

### 몬스터
- 몬스터는 죽으면 원래 자리에서 30초 후 부활한다.
- 몬스터는 가장 처음 인식한 플레이어를 쫓고, 해당 플레이어가 인식범위에서 벗어나면 근처의 다른 플레이어를 쫓거나, 배회한다.
- 몬스터 이동: 이동가능범위 안에 목표 위치를 설정하고 A*알고리즘을 사용하여 목표 위치로 이동한다.
    - 이동가능 범위: 원래위치로부터 반지름 10의 원
    - 목표위치는 원래위치에서 랜덤한 각도와 길이로 결정한다.
- 몬스터는 자신 이동/플레이어 이동시 업데이트 함수를 호출한다. 이동은 0.5초마다 이루어진다.
- 몬스터는 업데이트시에 적절한 행동을 결정한다(공격 등)

### 플레이어
- 체력이 100%가 아니라면 5초마다 10%의 체력을 회복한다. 레벨업시에는 체력이 100%로 회복된다.
- 체력이 0이 되면 경험치가 감소하고 가장 가까운 스폰위치에서 부활한다.
    - 경험치바를 기준으로 50% 감소한다. 현재 레벨이 10이고 경험치바가 20% 채워져있다면 레벨은 9가 되고 경험치바는 70%가 된다.
- 플레이어 정보는 DB에 저장된다.

### 전투
- 몬스터/플레이어는 공격의 방향이 없다(전방위 동시 공격)
- 몬스터/플레이어는 1초에 1번 공격한다.
    > 방향성을 추가하면 추가점수
- 전투상황은 메세지창에 출력된다.
    - "용사가몬스터A를때려서10의데미지를입혔습니다."
    - "몬스터A의공격으로15의데미지를입었습니다."
    - "몬스터A를무찔러서250의경험치를얻었습니다."
    > 본인의 전투상황만?
- 몬스터 처치시 경험치는 `레벨 * 레벨 * 2`로 한다.
- 월드에는 총 20만 마리의 몬스터가 존재한다.

### 지형
- 2000x2000의 이미지에서 불러온다.
- 흰색은 일반, 검은색은 이동불가, 초록색은 리스폰위치, 빨간색은 몬스터 스폰지역
- 플레이어/몬스터는 이동가능한 곳에서만 이동한다.
- 몬스터는 스폰지역에서만 스폰된다. 
    > 색의 채도에 따라 몬스터 능력치 구분?  
    > 몬스터 종류는?  

### 로그인
- 같은 아이디가 이미 접속해있다면 접속 거부
- 아이디가 DB에 존재하지 않는다면 아이디 생성 후 접속
- SQL injection을 방지해야한다.

### 채팅
- 채팅은 모든 플레이어에게 전송된다.
- 채팅 기록은 저장하지 않는다.

### DB
user data
| name | type | description |
|------|------|-------------|
| id(name) | string | 플레이어 식별자 |
| level | int | |
| exp | int | |
| hp | int | |
| x | int | 격자맵에서 움직이므로 정수로 표현 |
| y | int | 격자맵에서 움직이므로 정수로 표현 |
